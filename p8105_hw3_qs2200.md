p8105\_hw3\_qs2200
================
Qi Shao
10/7/2018

Problem 1
=========

**1. Import and clean the dataset.**

``` r
brfss_df = p8105.datasets::brfss_smart2010 %>%
  janitor::clean_names() %>%
  filter(topic == "Overall Health") %>%
  mutate(response = factor(response, levels = c("Excellent", "Very good", "Good","Fair", "Poor")))%>%
  rename(state = locationabbr) %>%
  arrange(response) 

##filter(topic == "Overall Health", response ==c("Excellent", "Very good", "Good","Fair", "Poor"))
##why can't we filter the rows which response is excellent to poor
```

**2. In 2002, which states were observed at 7 locations?**

``` r
brfss_state = 
  group_by(brfss_df , state) %>%
  summarize(n = n_distinct(locationdesc)) %>%
  filter(n == 7)
```

The 7 states CT, MT, NH, NM, OR, TN, UT were observed at 7 locations.

**3. Make a “spaghetti plot” that shows the number of observations in each state from 2002 to 2010.**

``` r
brfss_spa =
  group_by(brfss_df, state,year) %>%
  summarize(n_obs = n())

ggplot(brfss_spa, aes(x = year, y = n_obs, color = state))+
  geom_line()+geom_point()+
  labs(x = "Year",
    y = "Number of observations")
```

![](p8105_hw3_qs2200_files/figure-markdown_github/problem%201.3-1.png) **4. Make a table showing, for the years 2002, 2006, and 2010, the mean and standard deviation of the proportion of “Excellent” responses across locations in NY State.**

``` r
brfss_tb =
  filter(brfss_df, year %in% c(2002, 2006, 2010),
         state == "NY",
         response == "Excellent")%>%
  group_by(year) %>%
  summarize(mean_prop = mean(data_value), 
            sd_prop = sd(data_value, na.rm  = TRUE))
  knitr::kable(brfss_tb, digits = 2)
```

|  year|  mean\_prop|  sd\_prop|
|-----:|-----------:|---------:|
|  2002|       24.04|      4.49|
|  2006|       22.53|      4.00|
|  2010|       22.70|      3.57|

**5.For each year and state, compute the average proportion in each response category (taking the average across locations in a state). Make a five-panel plot that shows, for each response category separately, the distribution of these state-level averages over time.**

``` r
aver_exce = 
  filter(brfss_df, response == "Excellent") %>%
  group_by(state,year) %>%
  summarize(mean_prop = mean(data_value)) %>%
  ggplot(aes(x = year, y = mean_prop, color = state)) +
  geom_line() +
  theme(legend.position = "none")

aver_very = 
  filter(brfss_df, response == "Very good") %>%
  group_by(state,year) %>%
  summarize(mean_prop = mean(data_value)) %>%
  ggplot(aes(x = year, y = mean_prop, color = state)) +
  geom_line() +
  theme(legend.position = "none")

aver_good = 
  filter(brfss_df, response == "Good") %>%
  group_by(state,year) %>%
  summarize(mean_prop = mean(data_value)) %>%
  ggplot(aes(x = year, y = mean_prop, color = state)) +
  geom_line() +
  theme(legend.position = "none")

aver_fair = 
  filter(brfss_df, response == "Fair") %>%
  group_by(state,year) %>%
  summarize(mean_prop = mean(data_value)) %>%
  ggplot(aes(x = year, y = mean_prop, color = state)) +
  geom_line() +
  theme(legend.position = "none")

aver_poor = 
  filter(brfss_df, response == "Poor") %>%
  group_by(state,year) %>%
  summarize(mean_prop = mean(data_value)) %>%
  ggplot(aes(x = year, y = mean_prop, color = state)) +
  geom_line() +
  theme(legend.position = "bottom")

aver_exce + aver_very + aver_good + aver_fair + aver_poor
```

    ## Warning: Removed 3 rows containing missing values (geom_path).

    ## Warning: Removed 2 rows containing missing values (geom_path).

    ## Warning: Removed 2 rows containing missing values (geom_path).

    ## Warning: Removed 1 rows containing missing values (geom_path).

    ## Warning: Removed 1 rows containing missing values (geom_path).

![](p8105_hw3_qs2200_files/figure-markdown_github/problem%201.5-1.png)

Problem 2
---------

**1. Import, explore and describe the dataset.**

``` r
instacart_df = p8105.datasets::instacart 
```
